/*! snei-grand-central-device 2015-08-25 */
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.grandCentralDevice=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d=a("./src/core/logger");d.setLevel(d.ERROR)},{"./src/core/logger":4}],2:[function(b,c,d){!function(b){"use strict";var d={};d.VERSION="1.1.1";var e,f={},g=function(a,b){return function(){return b.apply(a,arguments)}},h=function(){var a,b,c=arguments,d=c[0];for(b=1;b<c.length;b++)for(a in c[b])a in d||!c[b].hasOwnProperty(a)||(d[a]=c[b][a]);return d},i=function(a,b){return{value:a,name:b}};d.DEBUG=i(1,"DEBUG"),d.INFO=i(2,"INFO"),d.TIME=i(3,"TIME"),d.WARN=i(4,"WARN"),d.ERROR=i(8,"ERROR"),d.OFF=i(99,"OFF");var j=function(a){this.context=a,this.setLevel(a.filterLevel),this.log=this.info};j.prototype={setLevel:function(a){a&&"value"in a&&(this.context.filterLevel=a)},enabledFor:function(a){var b=this.context.filterLevel;return a.value>=b.value},debug:function(){this.invoke(d.DEBUG,arguments)},info:function(){this.invoke(d.INFO,arguments)},warn:function(){this.invoke(d.WARN,arguments)},error:function(){this.invoke(d.ERROR,arguments)},time:function(a){"string"==typeof a&&a.length>0&&this.invoke(d.TIME,[a,"start"])},timeEnd:function(a){"string"==typeof a&&a.length>0&&this.invoke(d.TIME,[a,"end"])},invoke:function(a,b){e&&this.enabledFor(a)&&e(b,h({level:a},this.context))}};var k=new j({filterLevel:d.OFF});!function(){var a=d;a.enabledFor=g(k,k.enabledFor),a.debug=g(k,k.debug),a.time=g(k,k.time),a.timeEnd=g(k,k.timeEnd),a.info=g(k,k.info),a.warn=g(k,k.warn),a.error=g(k,k.error),a.log=a.info}(),d.setHandler=function(a){e=a},d.setLevel=function(a){k.setLevel(a);for(var b in f)f.hasOwnProperty(b)&&f[b].setLevel(a)},d.get=function(a){return f[a]||(f[a]=new j(h({name:a},k.context)))},d.useDefaults=function(a){if("undefined"!=typeof console){var b={},c=function(a,b){Function.prototype.apply.call(a,console,b)};d.setLevel(a||d.DEBUG),d.setHandler(function(a,e){var f,g=console.log;e.level===d.TIME?(f=(e.name?"["+e.name+"] ":"")+a[0],"start"===a[1]?console.time?console.time(f):b[f]=(new Date).getTime():console.timeEnd?console.timeEnd(f):c(g,[f+": "+((new Date).getTime()-b[f])+"ms"])):(e.level===d.WARN&&console.warn?g=console.warn:e.level===d.ERROR&&console.error?g=console.error:e.level===d.INFO&&console.info&&(g=console.info),e.name&&Array.prototype.unshift.call(a,"["+e.name+"] "),c(g,a))})}},"function"==typeof a&&a.amd?a(d):"undefined"!=typeof c&&c.exports?c.exports=d:(d._prevLogger=b.Logger,d.noConflict=function(){return b.Logger=d._prevLogger,d},b.Logger=d)}(this)},{}],3:[function(a,b,c){b.exports={}},{}],4:[function(a,b,c){var d=a("js-logger");d.useDefaults(),d.setHandler(function(a,b){var c=console.log;b.name&&(a[0]="["+b.name+"] "+a[0]),a[0]="[GC:DEVICE] "+a[0],b.level===d.DEBUG&&console.debug?c=console.debug:b.level===d.INFO&&console.info?c=console.info:b.level===d.WARN&&console.warn?c=console.warn:b.level===d.ERROR&&console.error&&(c=console.error),Function.prototype.apply.call(c,console,a)}),b.exports=d},{"js-logger":2}],5:[function(a,b,c){var d=a("./logger").get("PLATFORM"),e={PS3:"PS3",PS4:"PS4",PSBROWSER:"PSBROWSER",LUXRAY:"LUXRAY",UNKNOWN:"UNKNOWN",current:null};e.identify=function(){"undefined"!=typeof window&&window.navigator?window.navigator.sce?e.current=e.PS4:window.navigator.userAgent.indexOf("LGE")>-1&&window.navigator.userAgent.indexOf("webOS")>-1?e.current=e.LUXRAY:e.current=e.PSBROWSER:"undefined"!=typeof engine&&engine.stats&&engine.stats.device&&"ps3"===engine.stats.device.platform?e.current=e.PS3:e.current=e.UNKNOWN,d.info("Current platform identified as ",e.current)},e.identify(),b.exports=e},{"./logger":4}],6:[function(a,b,c){function d(){this.modules={}}a("./../gc.conf.js");var e=a("./core/globalConfig"),f=a("./core/logger"),g=a("./service/system/system"),h=a("./service/input/input"),i=a("./service/systemVoice/systemVoice");d.prototype.makeService=function(a){var b=this.modules[a];if("undefined"==typeof b)return f.error("Service "+a+" does not exist!"),null;var c=Array.prototype.slice.call(arguments,1);return c=[null].concat(c),new(Function.prototype.bind.apply(b,c))},d.prototype._defineService=function(a,b){"undefined"==typeof this.modules[a]&&(this.modules[a]=b)},d.prototype.getLogger=function(){return f},d.prototype.setConfig=function(a){Object.keys(a||{}).forEach(function(b){e[b]=a[b]})},d.prototype.getConfig=function(){return e},d.prototype.clearConfig=function(){Object.keys(e).forEach(function(a){delete e[a]})};var j=new d;j._defineService("system",g),j._defineService("input",h),j._defineService("system-voice",i),b.exports=j},{"./../gc.conf.js":1,"./core/globalConfig":3,"./core/logger":4,"./service/input/input":7,"./service/system/system":13,"./service/systemVoice/systemVoice":15}],7:[function(a,b,c){function d(){this.instance=null}function e(){this.attached=!1,this.keyMap=new f,this.keyUpCallback=null,this.keyDownCallback=null,this.onKeyUpBound=null,this.onKeyDownBound=null,this.joystickHandler=null}var f=a("./keyMap"),g=a("./inputEvent"),h=a("./../../core/platform"),i=a("./ps3StickToDPad"),j=a("./../../core/logger").get("INPUT");d.prototype.getInstance=function(){return this.instance||(j.info("Initializing input handler."),this.instance=new e),this.instance},d.prototype.destroyInstance=function(){this.instance&&(j.info("Destroying input handler."),this.instance.attached&&this.instance.detach(),this.instance=null)},e.prototype.attach=function(){this.attached?j.warn("Already attached."):(h.current===h.PS3?(engine.onKey=function(a){this.onKeyDown(a),a.onEnd=function(){this.onKeyUp(a)}.bind(this)}.bind(this),this.joystickHandler=new i({enableLeft:!0,onDigitalPress:this.onKeyDown.bind(this),onDigitalRelease:this.onKeyUp.bind(this)}),engine.onAnalogMove=this.joystickHandler.onStickMove.bind(this.joystickHandler)):(this.onKeyUpBound=this.onKeyUp.bind(this),this.onKeyDownBound=this.onKeyDown.bind(this),window.addEventListener("keyup",this.onKeyUpBound,!0),window.addEventListener("keydown",this.onKeyDownBound,!0)),this.attached=!0,j.info("Input is now attached."))},e.prototype.detach=function(){this.attached?(h.current===h.PS3?(engine.onKey=null,engine.onAnalogMove=null):(window.removeEventListener("keyup",this.onKeyUpBound,!0),window.removeEventListener("keydown",this.onKeyDownBound,!0)),this.attached=!1,j.info("Input is now detached.")):j.warn("Already detached.")},e.prototype.onKeyUp=function(a){var b,c=this.keyMap;b=h.current===h.PS3?new g(c.getInputType(a),a.name):new g(c.getInputType(a),a.keyCode),"function"==typeof this.keyUpCallback?"undefined"!=typeof b.type&&this.keyUpCallback(b):j.warn("Key up callback not registered. Use setOnKeyUp(callback);")},e.prototype.onKeyDown=function(a){var b,c=this.keyMap;b=h.current===h.PS3?new g(c.getInputType(a),a.name):new g(c.getInputType(a),a.keyCode),"function"==typeof this.keyDownCallback?"undefined"!=typeof b.type&&this.keyDownCallback(b):j.warn("Key down callback not registered. Use setOnKeyDown(callback);")},e.prototype.setOnKeyUp=function(a){this.keyUpCallback=a},e.prototype.setOnKeyDown=function(a){this.keyDownCallback=a},b.exports=d},{"./../../core/logger":4,"./../../core/platform":5,"./inputEvent":8,"./keyMap":9,"./ps3StickToDPad":10}],8:[function(a,b,c){function d(a,b){this.type=a,this.code=b}b.exports=d},{}],9:[function(a,b,c){function d(){this.generic=f,this.ps4=g,this.ps3=h,this.luxray=i}var e=a("./../../core/platform"),f={UP:"UP",DOWN:"DOWN",LEFT:"LEFT",RIGHT:"RIGHT",CROSS:"CROSS",CIRCLE:"CIRCLE",TRIANGLE:"TRIANGLE",SQUARE:"SQUARE",OPTIONS:"OPTIONS",START:"START",SELECT:"SELECT",L1:"L1",R1:"R1",L2:"L2",R2:"R2",L3:"L3",R3:"R3",PREV:"Prev",FF:"Ff",RWD:"Rwd",PLAY:"Play",STOP:"Stop",PAUSE:"Pause",TOPMENU:"Topmenu",POPUPMENU:"Popupmenu",SUBTITLE:"Subtitle",AUDIO:"Audio",GREEN:"GREEN",RED:"RED",YELLOW:"YELLOW",BLUE:"BLUE",PS:"PS"},g={13:f.CROSS,27:f.CIRCLE,37:f.LEFT,38:f.UP,39:f.RIGHT,40:f.DOWN,112:f.TRIANGLE,113:f.SQUARE,114:f.OPTIONS,116:f.L1,117:f.R1,118:f.L2,119:f.R2,120:f.L3,121:f.R3,122:f.PREV,126:f.FF,127:f.RWD,128:f.PLAY,129:f.STOP,130:f.PAUSE,132:f.TOPMENU,133:f.POPUPMENU,134:f.SUBTITLE,135:f.AUDIO,80:f.PS},h={275:f.CIRCLE,274:f.CROSS,273:f.SQUARE,276:f.TRIANGLE,269:f.UP,270:f.DOWN,271:f.LEFT,272:f.RIGHT,279:f.L1,280:f.L2,281:f.L3,282:f.R1,283:f.R2,284:f.R3,277:f.SELECT,278:f.START,ENTER:f.CROSS,ESCAPE:f.CIRCLE},i={13:f.CROSS,27:f.CIRCLE,37:f.LEFT,38:f.UP,39:f.RIGHT,40:f.DOWN,112:f.TRIANGLE,113:f.SQUARE,114:f.OPTIONS,116:f.L1,117:f.R1,118:f.L2,119:f.R2,120:f.L3,121:f.R3,461:f.CIRCLE,403:f.RED,404:f.GREEN,405:f.YELLOW,406:f.BLUE};d.prototype.getInputType=function(a){var b=null;switch(e.current){case e.PS3:b=this.ps3[a.name];break;case e.PS4:b=this.ps4[a.keyCode];break;case e.LUXRAY:b=this.luxray[a.keyCode];break;default:b=this.ps4[a.keyCode]}return b},d.prototype.getInputCode=function(a){var b=null,c=null;switch(e.current){case e.PS3:b=h;break;case e.PS4:b=g;break;case e.LUXRAY:b=i;break;default:b=g}for(var d=Object.keys(b),f=0;f<d.length&&null===c;++f){var j=d[f];b[j]===a&&(c=j)}return c},b.exports=d},{"./../../core/platform":5}],10:[function(a,b,c){function d(a){a=a||{},this.isLeftEnabled=a.enableLeft||!0,this.isRightEnabled=a.enableright||!1,this.digitalThreshold=a.digitalThreshold||.9,this.onDigitalPress=a.onDigitalPress||null,this.onDigitalRelease=a.onDigitalRelease||null,this.keyMap=new e,this.lastStickValue=[this._createKeyEvent(),this._createKeyEvent()]}var e=a("./keyMap"),f=a("./../../core/logger").get("PS3 JOYSTICK"),g=0,h=1;d.prototype.onStickMove=function(a,b,c){if(a===g||a===h){var d=null;this._isOverThreshold(b,c)&&(d=Math.abs(b)>Math.abs(c)?b>0?this.keyMap.generic.RIGHT:this.keyMap.generic.LEFT:c>0?this.keyMap.generic.DOWN:this.keyMap.generic.UP);var e=this._createKeyEvent(d);this.isLeftEnabled&&a===g&&this._processKeyEvent(a,e),this.isRightEnabled&&a===h&&f.warn("Right Stick input not implemented.")}},d.prototype._processKeyEvent=function(a,b){this.lastStickValue[a].name!==b.name&&(null!=this.lastStickValue[a].name&&(this.onDigitalRelease?this.onDigitalRelease(this.lastStickValue[a]):f.warn("onDigitalRelease not set, stick events will not propagate to input handler!")),null!=b.name&&(this.onDigitalPress?this.onDigitalPress(b):f.warn("onDigitalPress not set, stick events will not propagate to input handler!")),this.lastStickValue[a]=b)},d.prototype._isOverThreshold=function(a,b){return a>this.digitalThreshold||a<-this.digitalThreshold||b>this.digitalThreshold||b<-this.digitalThreshold?!0:!1},d.prototype._createKeyEvent=function(a){var b={name:null};return a&&(b.name=this.keyMap.getInputCode(a)),b},b.exports=d},{"./../../core/logger":4,"./keyMap":9}],11:[function(a,b,c){function d(){this.psns=new e(this)}var e=a("./psns"),f=a("./../../../core/platform"),g=a("./../../../core/logger").get("DEEP LINKER");d.prototype.addListener=function(a){f.current===f.PS4&&sce.addSystemEventListener("onLocationChange",a)},d.prototype.removeListener=function(a){f.current===f.PS4&&sce.removeSystemEventListener("onLocationChange",a)},d.prototype.custom=function(a){this._open(a)},d.prototype._open=function(a){f.current===f.PS4?(g.info("Opening "+a),sce.launchApp(a)):g.error("Not supported on "+f.current)},b.exports=d},{"./../../../core/logger":4,"./../../../core/platform":5,"./psns":12}],12:[function(a,b,c){function d(a){this.dlInterface=a}d.prototype.browseCategory=function(a,b,c){var d="psns:browse?category="+a;b&&(d+="&type="+b),c&&(d+="&reward="+c),this.dlInterface._open(d)},d.prototype.browseProduct=function(a,b){var c="psns:browse?product="+a;b&&(c+="&type="+b),this.dlInterface._open(c)},d.prototype.browseGames=function(){this.dlInterface._open("psns:browse?top=game")},d.prototype.browseVideos=function(){this.dlInterface._open("psns:browse?top=video")},d.prototype.browseComics=function(){this.dlInterface._open("psns:browse?top=comic")},d.prototype.browsePSM=function(){this.dlInterface._open("psns:browse?top=psm")},d.prototype.searchFor=function(a,b,c){var d="psns:browse?search="+a+"&q="+b;c&&(d+="&scope="+c),this.dlInterface._open(d)},d.prototype.browseTarget=function(a){var b="psns:browse?target=plus";a&&(b+="&exp="+a),this.dlInterface._open(b)},d.prototype.browseGame=function(a){this.dlInterface._open("psns:browse?content="+a)},d.prototype.browseVideo=function(a){this.dlInterface._open("psns:browse?file="+a)},d.prototype.browseTrophies=function(a){this.dlInterface._open("psns:browse?comm="+a+"&pivod=trophy")},d.prototype.browseRanking=function(a){this.dlInterface._open("psns:browse?comm="+a+"&pivod=ranking")},d.prototype.redeemVoucher=function(a,b,c){var d="psns:redeem";d+=b&&c?"?code1="+a+"&code2="+b+"&code3="+c:"?code="+a,this.dlInterface._open(d)},b.exports=d},{}],13:[function(a,b,c){function d(){var a={},b=location.search.slice(1);if(b.length>1){var c=b.split("&");c.forEach(function(b){var c=b.split("=");a[c[0]]=c[1]})}return a.app&&(a.app=a.app+"/"),a}function e(){this.initialized=!1,this.platforms={ps3:g.PS3,ps4:g.PS4,psBrowser:g.PSBROWSER,luxray:g.LUXRAY,unknown:g.UNKNOWN},this.deepLinker=new h}var f=a("./../../core/logger").get("SYSTEM"),g=a("./../../core/platform"),h=a("./deepLinker/deepLinker");e.prototype.init=function(){return this.initialized?!1:(g.current===g.PS4&&sce.addSystemEventListener("onLocationChange",function(a){var b=~~a.session_id;f.log("finishing location change",b),sce.didFinishLocationChange(b)}),this.initialized=!0,!0)},e.prototype.ready=function(){if(g.current===g.PS4){var a=~~d().load_id;sce.didFinishLoading(a)}},e.prototype.getPlatformString=function(){return g.current},b.exports=e},{"./../../core/logger":4,"./../../core/platform":5,"./deepLinker/deepLinker":11}],14:[function(a,b,c){function d(){}var e=a("./../../../core/logger").get("SYSTEM VOICE");d.prototype.show=function(a,b){if(!a||!b)return void e.warn("#show called without settings or style!");e.info("showing system voice with:",a,b);var c={enter:a.enter,back:a.back,triangle:a.triangle,square:a.square,options:a.select,title:null,showUser:void 0===b.showUser?!0:b.showUser,up:a.up,down:a.down,left:a.left,right:a.right,l1:a.l1,r1:a.r1,l2:a.l2,r2:a.r2,share:a.share,footerStyle:b.footerStyle};sce.setFrameInfo(c)},d.prototype.hide=function(){e.info("hiding system voice"),sce.setFrameProperty(null,null,null,null,null,null,null,null,null,null,null)},b.exports=d},{"./../../../core/logger":4}],15:[function(a,b,c){function d(a){this._loadApi()}var e=a("./../../core/platform"),f=a("./../../core/logger").get("SYSTEM VOICE");d.prototype.show=function(a,b){f.warn("#show not implemented on ",e.current)},d.prototype.hide=function(){f.warn("#hide not implemented on ",e.current)},d.prototype._loadApi=function(){var b=null;switch(e.current){case e.PS4:b=a("./api/ps4");break;case e.PS3:case e.PSBROWSER:default:f.error("Not implemented for "+e.current)}if(b){f.info("Loading API for "+e.current);var c=new b;this.show=c.show,this.hide=c.hide}},b.exports=d},{"./../../core/logger":4,"./../../core/platform":5,"./api/ps4":14}]},{},[6])(6)});